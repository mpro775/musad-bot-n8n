# Runbook: Cache Miss Spike

## الأعراض

- ارتفاع في نسبة cache misses في Grafana.
- تنبيهات من Alertmanager تشير إلى `CacheMissSpike`.
- زيادة في زمن استجابة التطبيق بسبب زيادة الاستعلامات إلى قاعدة البيانات.

## تشخيص

1.  **تحقق من لوحة مراقبة Grafana:** افتح لوحة مراقبة الكاش وابحث عن:
    *   `cache_miss_total`: لتحديد المفاتيح التي تسبب cache misses.
    *   `cache_hit_total`: لمقارنة نسبة cache hits إلى misses.
2.  **فحص سجلات التطبيق:** ابحث عن أي أخطاء تتعلق بالكاش أو استعلامات قاعدة البيانات.
3.  **مراجعة منطق الكاش:** تحقق من منطق التخزين المؤقت (caching logic) في الكود للتأكد من أنه يعمل كما هو متوقع.

## حلول فورية

-   **مسح الكاش:** قد يساعد مسح الكاش في حل المشكلة مؤقتًا إذا كانت ناتجة عن بيانات غير صالحة.
-   **إعادة تشغيل خدمة الكاش:** إذا كانت المشكلة في خدمة الكاش نفسها (مثل Redis)، قد تساعد إعادة تشغيلها.

## حلول دائمة

-   **تحسين منطق الكاش:** قم بتحسين منطق التخزين المؤقت لزيادة نسبة cache hits.
-   **زيادة حجم الكاش:** إذا كان حجم الكاش غير كافٍ، قم بزيادته.
-   **استخدام Cache Warmer:** قم بتسخين الكاش مسبقًا بالبيانات المستخدمة بشكل متكرر.

## Postmortem

-   **تحليل السبب الجذري:** قم بتوثيق السبب الجذري للمشكلة.
-   **الإجراءات المتخذة:** وثق الإجراءات التي تم اتخاذها لحل المشكلة.
-   **الدروس المستفادة:** سجل الدروس المستفادة لمنع تكرار المشكلة في المستقبل.

